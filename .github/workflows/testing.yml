name: Testing

on: [push, pull_request]

concurrency:
  cancel-in-progress: ${{ !contains(github.ref, 'release/')}}
  group: tests-${{ github.workflow }}-${{ github.ref }}

jobs:
  unit:
    name: Unit Testing
    uses: ./.github/workflows/run-test-suite.yml
    with:
      fail-fast: false
      test-command: composer test:unit

  functional:
    name: Functional Testing
    uses: ./.github/workflows/run-test-suite.yml
    with:
      fail-fast: false
      test-command: composer test:func
      download-binaries: true

  acceptance-slow:
    name: Acceptance Testing (Slow)
    uses: ./.github/workflows/run-test-suite.yml
    with:
      fail-fast: false
      test-command: composer test:accept-slow
      download-binaries: true

  acceptance-fast:
    name: Acceptance Testing (Fast)
    uses: ./.github/workflows/run-test-suite.yml
    with:
      fail-fast: false
      test-command: composer test:accept-fast
      download-binaries: true
